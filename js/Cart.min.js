"use strict";class Cart{constructor(t,a="#cart"){this.source=t,this.container=a,this.countGoods=0,this.amount=0,this.cartItems=[],this._init()}_init(){this._render(),fetch(this.source).then(t=>t.json()).then(t=>{for(let a of t.contents)this.cartItems.push(a),this._renderItem(a);this.countGoods=t.countGoods,this.amount=t.amount,this._renderSum()})}_render(){let t=$("<div/>",{class:"cart-drop"}),a=$("<div/>",{class:"cart-items"}),s=$("<div/>",{class:"cart-countGoods"}),e=$("<div/>",{class:"cart-total"}),c=$("<a/>",{class:"cart-checkout",href:"checkout.html",text:"checkout"}),r=$("<a/>",{class:"cart-goToCart",href:"shopping_cart.html",text:"go to cart"});s.append($('<span class="sum-goods">0</span>')),e.append($('<span>total</span><span class="sum-price">$0</span>')),s.appendTo($(this.container)),a.appendTo(t),e.appendTo(t),c.appendTo(t),r.appendTo(t),t.appendTo($(this.container))}_renderItem(t){let a=$("<div/>",{class:"cart-item","data-product":t.id_product}),s=$("<div/>",{class:"cart-itemWrapper"}),e=$("<div/>",{class:"cart-text"}),c=$("<div/>",{class:"raty-star"});c.raty({starType:"i",half:!0,score:4.5});let r=$('<div class="cart-btnRemove-wrapper">\n        <a href="#" class="cart-btnRemove"><i class="fas fa-times-circle"></i></a></div>');r.click(()=>{this._remove(t.id_product)}),s.append($(`<img src="${t.src}" alt="photo" class="cart-img">`)),e.append($(`<p class="cart-textName">${t.product_name}</p>`)),e.append(c),e.append($(`<p class="cart-textPrice">${t.quantity} x $${t.price}</p>`)),e.appendTo(s),s.appendTo(a),a.append(r),a.appendTo($(".cart-items"))}_renderSum(){$(".sum-goods").text(`${this.countGoods}`),$(".sum-price").text(`$${this.amount}`)}_updateCart(t){$(`div[data-product="${t.id_product}"]`).find(".cart-textPrice").text(`${t.quantity} x $${t.quantity*t.price}`)}addProduct(t){let a=+$(t).data("id"),s=this.cartItems.find(t=>t.id_product===a);if(s)s.quantity++,this.countGoods++,this.amount+=s.price,this._updateCart(s);else{let s={id_product:a,product_name:$(t).data("name"),price:+$(t).data("price"),quantity:1,src:$(t).data("src")};this.cartItems.push(s),this._renderItem(s),this.amount+=s.price,this.countGoods+=s.quantity}this._renderSum()}_remove(t){let a=this.cartItems.find(a=>a.id_product===t);a.quantity>1?(a.quantity--,this._updateCart(a)):(this.cartItems.splice(this.cartItems.indexOf(a),1),$(`div[data-product="${t}"]`).remove()),this.countGoods--,this.amount-=a.price,this._renderSum()}}